# This file contains definitions of CI job parameters that are loaded
# dynamically in CI from ci.yml.
# You *do not* need to re-run `src/tools/expand-yaml-anchors` when you
# modify this file.
shared_defs:
  - &base-job
    env: { }

  - &job-linux-4c
    os: ubuntu-20.04-4core-16gb
    <<: *base-job

  - &job-linux-8c
    os: ubuntu-20.04-8core-32gb
    <<: *base-job

  - &job-linux-16c
    os: ubuntu-20.04-16core-64gb
    <<: *base-job

  - &job-macos-xl
    os: macos-13 # We use the standard runner for now
    <<: *base-job

  - &job-macos-m1
    os: macos-14
    <<: *base-job

  - &job-windows-8c
    os: windows-2022
    <<: *base-job

  - &job-windows-16c
    os: windows-2019-16core-64gb
    <<: *base-job

  - &job-aarch64-linux
    os: [ self-hosted, ARM64, linux ]

pr:
  - name: dist-arm64ec-msvc
    env:
      RUST_CONFIGURE_ARGS: >-
        --build=x86_64-pc-windows-msvc
        --target=arm64ec-pc-windows-msvc
        --set build.docs=false
      SCRIPT: python x.py dist bootstrap --include-default-paths
      BOOTSTRAP_SKIP_TARGET_SANITY: 1
    <<: *job-windows-8c
